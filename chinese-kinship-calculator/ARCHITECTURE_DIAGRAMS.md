# Architecture Diagram: In-Law Relationships

## Resolution Flow Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 resolveRelationship(path, age)              â”‚
â”‚                    Entry Point: Router                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚            â”‚            â”‚               â”‚
        â†“            â†“            â†“               â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”
    â”‚Spouse? â”‚  â”‚Sib+Sp?   â”‚  â”‚Cousin?     â”‚  â”‚Other â”‚
    â”‚Branch  â”‚  â”‚uorspouse â”‚  â”‚Scenario    â”‚  â”‚Blood â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”¬â”€â”€â”€â”˜
         â”‚           â”‚             â”‚             â”‚
    [wife/husb    [sib+wife    [parent+sibling  Map
     + relative]   /husband]     + child]      Lookup
         â”‚           â”‚             â”‚             â”‚
         â†“           â†“             â†“             â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Resolve       â”‚  â”‚Resolve Sibling  â”‚  â”‚ResolveFirst  â”‚
    â”‚SpouseBranch  â”‚  â”‚Spouse           â”‚  â”‚Cousin        â”‚
    â”‚              â”‚  â”‚                 â”‚  â”‚              â”‚
    â”‚A) Parents    â”‚  â”‚â€¢ older_brâ†’å©†   â”‚  â”‚â€¢ å ‚å“¥/å ‚å¼Ÿ   â”‚
    â”‚B) Siblings   â”‚  â”‚â€¢ younger_brâ†’åª³  â”‚  â”‚â€¢ è¡¨å“¥/è¡¨å¼Ÿ   â”‚
    â”‚C) Single     â”‚  â”‚â€¢ older_sisâ†’å§å¤« â”‚  â”‚â€¢ å ‚å§/å ‚å¦¹   â”‚
    â”‚   token      â”‚  â”‚â€¢ younger_sisâ†’å¦¹å¤« â”‚  â”‚â€¢ è¡¨å§/è¡¨å¦¹   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                  â”‚                   â”‚
         â”‚                  â”‚                   â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   Return Result    â”‚
         â”‚   e.g., "å²³çˆ¶"    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Decision Tree: Path Analysis

```
                    Input: [token1, token2, ...]
                            â”‚
                            â†“
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚ token1 == wife?     â”‚
                  â”‚ token1 == husband?  â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                   YES     â”‚      â”‚     NO
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â†“                       â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Spouse      â”‚          â”‚ token1 is sibling?â”‚
            â”‚ Branch      â”‚          â”‚ token2 is spouse?â”‚
            â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                  â”‚                  YES   â”‚        â”‚   NO
           â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”
           â†“            â†“            â†“                    â†“
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚len>2?  â”‚  â”‚token2==  â”‚ â”‚Sibling+  â”‚        â”‚parent+parent â”‚
      â”‚Too deepâ”‚  â”‚father/   â”‚ â”‚spouse    â”‚        â”‚_sib+child?   â”‚
      â”‚        â”‚  â”‚mother?   â”‚ â”‚resolve   â”‚        â”‚â†’Cousin logic â”‚
      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜  â”‚â†’In-laws  â”‚ â”‚          â”‚        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
         YES      â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              YES
         â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
         â”œâ”€â”€â”€ERRORâ”€â”€â†’         â†“                          â†“
         â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚        â”‚token2 is      â”‚        â”‚resolveFirstCousin()  â”‚
         â”‚        â”‚sibling?       â”‚        â”‚Returns: å ‚å“¥, è¡¨å¼Ÿ   â”‚
         â”‚        â”‚â†’Calculate     â”‚        â”‚         based on     â”‚
         â”‚        â”‚in-law name    â”‚        â”‚         relativeAge  â”‚
         â”‚        â”‚(wife/husband  â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚        â”‚dependent)     â”‚                 â”‚
         â”‚        â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â†“
         â”‚              â†“          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚          Return         â”‚   Direct Map Lookup  â”‚
         â”‚          in-law         â”‚   relationshipMap    â”‚
         â”‚          (e.g.,å²³çˆ¶)    â”‚   e.g., fatherâ†’çˆ¸çˆ¸ â”‚
         â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                    â†“
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚   Return Result  â”‚
                 â”‚  or "error msg"  â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## State Machine: Relationship Classification

```
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚  START: [path array]    â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚                         â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  Spouse Branch Check   â”‚    â”‚ Sibling Spouse Check     â”‚
        â”‚  (path[0] is spouse)   â”‚    â”‚ (path=[sib, spouse])     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             YESâ”‚       â”‚NO                  â”‚YES    â”‚NO
                â†“       â”‚                    â†“       â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
         â”‚Spouse   â”‚    â”‚              â”‚Sibling's   â”‚â”‚
         â”‚Branch   â”‚    â”‚              â”‚Spouse      â”‚â”‚
         â”‚Logic    â”‚    â”‚              â”‚Logic       â”‚â”‚
         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜    â”‚              â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜â”‚
              â”‚         â”‚                    â”‚       â”‚
              â”‚    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚       â”‚
              â”‚    â”‚             â”‚            â”‚       â”‚
              â”‚    â†“             â†“            â†“       â”‚
              â”‚  Cousin?      Invalid?    Valid?     â”‚
              â”‚  (3-token     (too deep)   Sibling   â”‚
              â”‚   parent+     ?â†’Error      Spouse?   â”‚
              â”‚   sib+child)  â†“            Yesâ†“      â”‚
              â”‚    â”‚         Error msg    Result    â”‚
              â”‚    â”‚                       â”‚
              â”‚    â”œâ”€â”€Cousin Logicâ”€â†’Result â”‚
              â”‚    â”‚                       â”‚
              â””â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚                       â”‚
                   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ â”‚
                   â†“ â†“
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚  Blood Mapping  â”‚
                â”‚  Direct Lookup  â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â†“
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚    Return Result    â”‚
              â”‚ (Relationship Name) â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow: Wife's Father Example

```
UI Click: è€å©† â†’ çˆ¸çˆ¸ â†’ =
          â”‚      â”‚      â”‚
          â†“      â†“      â†“
       Input: ['wife', 'father']
              â”‚
              â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ resolveRelationship()        â”‚
    â”‚  path=['wife', 'father']    â”‚
    â”‚  age=null                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ isSpouseBranch()     â”‚
    â”‚ path[0]='wife'?      â”‚
    â”‚ YES â†’ true           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ resolveSpouseBranch()    â”‚
    â”‚ path=['wife','father']   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
        â†“             â†“
   Check depth   Check spouse
   2 â‰¤ 2? âœ“       type
        â”‚         t1='wife'
        â”‚         t2='father'
        â”‚         isWife=true
        â”‚         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                  â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ if (t2 === 'father') {   â”‚
        â”‚   return isWife ? 'å²³çˆ¶'  â”‚
        â”‚                          â”‚
        â”‚ Result: 'å²³çˆ¶'           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Display Result:     â”‚
        â”‚     å²³çˆ¶   ğŸ”Š       â”‚
        â”‚  (+ volume icon)    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow: Older Brother's Wife Example

```
UI Click: å“¥å“¥ â†’ è€å©† â†’ =
          â”‚     â”‚      â”‚
          â†“     â†“      â†“
       Input: ['older_brother', 'wife']
              â”‚
              â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ resolveRelationship()         â”‚
    â”‚  path=['older_brother','wife']â”‚
    â”‚  age=null                     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ isSpouseBranch()     â”‚
    â”‚ path[0]='older_' ? NO
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ isSiblingSpouse()        â”‚
    â”‚ path.length==2 ? YES     â”‚
    â”‚ path[0] is sibling? YES  â”‚
    â”‚ path[1] is spouse? YES   â”‚
    â”‚ Result: TRUE             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ resolveSiblingSpouse()   â”‚
    â”‚ path=['older_brother',   â”‚
    â”‚       'wife']            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
        â†“             â†“
    t1='older_'   t2='wife'
    brother       isWife=true
        â”‚             â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                      â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ if (isWife) {            â”‚
        â”‚   if (t1==='older_br')   â”‚
        â”‚     return 'å«‚å­'        â”‚
        â”‚                          â”‚
        â”‚ Result: 'å«‚å­'           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Display Result:     â”‚
        â”‚     å«‚å­   ğŸ”Š       â”‚
        â”‚  (+ volume icon)    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Scope Coverage: What's Supported

```
Generation Level Visualization:

  Spouse's Parents      (Supported âœ“)
         â”‚ â† wife/husband
         â”‚
  Generation 0          (Supported âœ“)
   You â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Spouse
         â”‚ â† wife/husband
         â”‚
  Spouse's Siblings     (Supported âœ“)
         â”‚
         â”‚ â† brothers/sisters
         â”‚
         â””â”€â†’ wife/husband
             â”‚
  Your Siblings' Spouse (Supported âœ“)

  (Max Depth = 2: Spouse + 1 Relative)
```

---

## Unsupported Patterns (By Design)

```
Too Deep (>2 levels):
  [wife, father, brother, son]  â† 4 levels, blocked
  [husband, mother, daughter]   â† 3 levels, blocked

Why? Maintains simplicity and avoids exponential complexity

Invalid Combinations:
  [older_brother, husband]      â† Invalid (brotherâ†’husband)
  [younger_sister, wife]        â† Invalid (sisterâ†’wife)
  [father, wife]                â† Invalid (not direct spouse)

Why? Only specific patterns are semantically valid
```

---

## Extension Example: How to Add Spouse's Nieces

If you want to support `wife` â†’ `older_brother` â†’ `daughter`:

```javascript
// Update: resolveSpouseBranch()

function resolveSpouseBranch(path) {
  // OLD: max depth = 2
  if (path.length > 2) {
    return "æš‚ä¸æ”¯æŒæ›´æ·±å±‚çš„å§»äº²å…³ç³»";
  }

  // NEW: allow depth 3
  if (path.length > 3) {
    // Changed from > 2
    return "æš‚ä¸æ”¯æŒæ›´æ·±å±‚çš„å§»äº²å…³ç³»";
  }

  const [t1, t2, t3] = path; // Add t3

  // ... existing code ...

  // NEW: Handle spouse's siblings' children
  if (path.length === 3) {
    const isWife = t1 === "wife";
    const isHusband = t1 === "husband";
    const isSibling =
      t2 === "older_brother" ||
      t2 === "younger_brother" ||
      t2 === "older_sister" ||
      t2 === "younger_sister";
    const isChild = t3 === "son" || t3 === "daughter";

    if (isSibling && isChild) {
      // Add logic here
      // e.g., wife + older_brother + son = å¤§èˆ…å­çš„å„¿å­
    }
  }

  return "æš‚æ—¶æ— æ³•è§£æ";
}
```

This shows how the architecture is extensible!
